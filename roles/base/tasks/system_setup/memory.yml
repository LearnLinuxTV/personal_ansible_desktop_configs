- name: system setup | memory | adjust current swappiness
  tags: swappiness,sysctl,system,setup
  ansible.builtin.lineinfile:
    dest: "/etc/sysctl.conf"
    create: yes
    regexp: "swappiness ="
    line: "vm.swappiness = 5"
  register: swappiness

- name: system setup | memory | apply swappiness
  tags: swappiness,sysctl,system,setup
  ansible.builtin.command: sysctl vm.swappiness={{ swappiness_value }}
  when: swappiness.changed

- name: system setup | memory | install earlyoom package
  tags: earlyoom,packages,system,setup
  ansible.builtin.package:
    name: earlyoom
    state: latest

- name: system setup | memory | enable and start earlyoom
  tags: earlyoom,packages,system,setup
  ansible.builtin.service:
    name: earlyoom
    enabled: yes
    state: started
